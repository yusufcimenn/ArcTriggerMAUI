<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="ArcTriggerMAUI.Pages.OrderWindowPage"
             Title="OrderWindowPage"
             BackgroundColor="{DynamicResource PageBackgroundColor}">

    <ContentPage.Resources>
        <!-- compact -->
        <x:Double x:Key="FontSmall">12</x:Double>
        <x:Double x:Key="ControlHeight">28</x:Double>
        <x:Double x:Key="ChipHeight">26</x:Double>

        <Style TargetType="Label">
            <Setter Property="TextColor" Value="{DynamicResource PrimaryTextColor}" />
            <Setter Property="FontSize" Value="{StaticResource FontSmall}" />
        </Style>

        <Style TargetType="Entry">
            <Setter Property="HeightRequest" Value="{StaticResource ControlHeight}" />
            <Setter Property="BackgroundColor" Value="{DynamicResource SecondaryBackgroundColor}" />
            <Setter Property="TextColor" Value="{DynamicResource PrimaryTextColor}" />
            <Setter Property="PlaceholderColor" Value="#8A8A8A" />
            <Setter Property="Margin" Value="4,0" />
        </Style>

        <Style TargetType="Picker">
            <Setter Property="HeightRequest" Value="{StaticResource ControlHeight}" />
            <Setter Property="BackgroundColor" Value="{DynamicResource SecondaryBackgroundColor}" />
            <Setter Property="TextColor" Value="{DynamicResource PrimaryTextColor}" />
            <Setter Property="TitleColor" Value="#8A8A8A" />
            <Setter Property="Margin" Value="4,0" />
        </Style>

        <Style TargetType="Button">
            <Setter Property="HeightRequest" Value="28" />
            <Setter Property="CornerRadius" Value="6" />
            <Setter Property="BackgroundColor" Value="#242e2a" />
            <Setter Property="TextColor" Value="White" />
            <Setter Property="Padding" Value="8,2" />
            <Setter Property="Margin" Value="4,0" />
        </Style>

        <Style x:Key="ChipButton" TargetType="Button">
            <Setter Property="HeightRequest" Value="{StaticResource ChipHeight}" />
            <Setter Property="CornerRadius" Value="6" />
            <Setter Property="BackgroundColor" Value="{DynamicResource SecondaryBackgroundColor}" />
            <Setter Property="TextColor" Value="{DynamicResource PrimaryTextColor}" />
            <Setter Property="BorderColor" Value="#3A3A3A" />
            <Setter Property="BorderWidth" Value="1" />
            <Setter Property="Padding" Value="2,2" />
            <Setter Property="Margin" Value="4,0" />
        </Style>

        <Style x:Key="ActionDanger" TargetType="Button">
            <Setter Property="HeightRequest" Value="28" />
            <Setter Property="CornerRadius" Value="10" />
            <Setter Property="Padding" Value="12,2" />
            <Setter Property="BackgroundColor" Value="#EF4444" />
            <Setter Property="TextColor" Value="White" />
            <Setter Property="Margin" Value="0" />
        </Style>

        <Style x:Key="ActionNeutral" TargetType="Button">
            <Setter Property="HeightRequest" Value="28" />
            <Setter Property="CornerRadius" Value="10" />
            <Setter Property="Padding" Value="12,2" />
            <Setter Property="BackgroundColor" Value="#E5E7EB" />
            <Setter Property="TextColor" Value="#111827" />
            <Setter Property="Margin" Value="0" />
        </Style>

        <!-- colors -->
        <Color x:Key="PageBackgroundColor">#0E1116</Color>
        <Color x:Key="SecondaryBackgroundColor">#1B1F24</Color>
        <Color x:Key="PrimaryTextColor">#EDEDED</Color>
        <Color x:Key="CardBorderColor">#2A2F36</Color>
        <Color x:Key="AccentGreen">#25C160</Color>
    </ContentPage.Resources>

    <Grid Padding="8" HorizontalOptions="Fill" VerticalOptions="Fill">
        <Frame HorizontalOptions="Fill"
               VerticalOptions="Center"
               BackgroundColor="{DynamicResource SecondaryBackgroundColor}"
               BorderColor="{DynamicResource CardBorderColor}"
               CornerRadius="12"
               HasShadow="False"
               Padding="10">

            <Grid RowDefinitions="Auto,Auto" ColumnDefinitions="*,Auto">

                <!-- TOP ROW: inputs -->
                <ScrollView Orientation="Horizontal" Grid.Row="0" Grid.Column="0">
                    <HorizontalStackLayout Spacing="10" Padding="6,2" HorizontalOptions="Fill">

                        <!-- Stock -->
                        <VerticalStackLayout Spacing="2">
                            <Label Text="Stock" />
                            <Picker x:Name="StockPicker" Title="Symbol" SelectedIndexChanged="OnSymbolChanged">
                                <Picker.Items>
                                    <x:String>AAPL</x:String>
                                    <x:String>MSFT</x:String>
                                    <x:String>NVDA</x:String>
                                    <x:String>TSLA</x:String>
                                    <x:String>GOOGL</x:String>
                                    <x:String>AMZN</x:String>
                                </Picker.Items>
                            </Picker>
                        </VerticalStackLayout>

                        <!-- Trigger -->
                        <VerticalStackLayout Spacing="2">
                            <Label Text="Trigger Level" />
                            <Grid ColumnSpacing="4">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="28" />
                                    <ColumnDefinition Width="28" />
                                </Grid.ColumnDefinitions>
                                <Entry x:Name="TriggerEntry" Grid.Column="0" Placeholder="100.00" Keyboard="Numeric" TextChanged="OnTriggerPriceTextChanged"/>
                                <Button Grid.Column="1" Text="▲" Clicked="OnIncreaseTriggerClicked"/>
                                <Button Grid.Column="2" Text="▼" Clicked="OnDecreaseTriggerClicked"/>
                            </Grid>
                        </VerticalStackLayout>

                        <!-- Type -->
                        <VerticalStackLayout Spacing="2">
                            <Label Text="Type" />
                            <HorizontalStackLayout Spacing="12" VerticalOptions="Center">
                                <RadioButton Content="Call" IsChecked="True" TextColor="{DynamicResource PrimaryTextColor}" CheckedChanged="OnCallOptionCheckedChanged"/>
                                <RadioButton Content="Put" TextColor="{DynamicResource PrimaryTextColor}" CheckedChanged="OnPutOptionCheckedChanged"/>
                            </HorizontalStackLayout>
                        </VerticalStackLayout>

                        <!-- Order -->
                        <VerticalStackLayout Spacing="2">
                            <Label Text="Order" />
                            <HorizontalStackLayout Spacing="12" VerticalOptions="Center">
                                <RadioButton Content="MKT" IsChecked="True" TextColor="{DynamicResource PrimaryTextColor}" CheckedChanged="OnCallOptionCheckedChanged"/>
                                <RadioButton Content="LMT" TextColor="{DynamicResource PrimaryTextColor}" CheckedChanged="OnPutOptionCheckedChanged"/>
                            </HorizontalStackLayout>
                        </VerticalStackLayout>

                        <!-- Offset -->
                        <VerticalStackLayout Spacing="2">
                            <Label Text="Offset" />
                            <Entry x:Name="OffsetEntry" Placeholder=".05" Keyboard="Numeric" HorizontalTextAlignment="End"/>
                            <HorizontalStackLayout Spacing="4">
                                <Button Text=".05" Style="{StaticResource ChipButton}" Clicked="OnOffsetPresetClicked"/>
                                <Button Text=".15" Style="{StaticResource ChipButton}" Clicked="OnOffsetPresetClicked"/>
                                <Button Text=".25" Style="{StaticResource ChipButton}" Clicked="OnOffsetPresetClicked"/>
                            </HorizontalStackLayout>
                        </VerticalStackLayout>

                        <!-- Strike / Expiry -->
                        <VerticalStackLayout Spacing="2">
                            <Label Text="Strike / Expiry" />
                            <Grid ColumnSpacing="6">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <Picker x:Name="StrikePicker" Grid.Column="0" Title="Strike" SelectedIndexChanged="OnStrikeChanged">
                                    <Picker.Items>
                                        <x:String>120</x:String>
                                        <x:String>125</x:String>
                                        <x:String>130</x:String>
                                        <x:String>135</x:String>
                                        <x:String>140</x:String>
                                    </Picker.Items>
                                </Picker>
                                <Picker x:Name="ExpPicker" Grid.Column="1" Title="dd/mm/yyyy" SelectedIndexChanged="OnExpirationChanged">
                                    <Picker.Items>
                                        <x:String>2025-09-20</x:String>
                                        <x:String>2025-10-18</x:String>
                                        <x:String>2025-11-15</x:String>
                                        <x:String>2025-12-20</x:String>
                                    </Picker.Items>
                                </Picker>
                            </Grid>
                        </VerticalStackLayout>

                        <!-- Optional flag -->
                        <HorizontalStackLayout Spacing="6" VerticalOptions="Center">
                            <CheckBox x:Name="AlphaCheck"/>
                            <Label Text="Alpha" VerticalOptions="Center"/>
                        </HorizontalStackLayout>

                    </HorizontalStackLayout>
                </ScrollView>

                <!-- TOP RIGHT: Place Order -->
                <Button Grid.Row="0" Grid.Column="1"
                        Text="Place Order"
                        HeightRequest="32"
                        CornerRadius="10"
                        Padding="16,4"
                        BackgroundColor="{DynamicResource AccentGreen}"
                        TextColor="Black"
                        FontAttributes="Bold"
                        Clicked="OnCreateOrderClicked"/>

                <!-- BOTTOM LEFT: Entry + chip buttons -->
                <ScrollView Orientation="Horizontal" Grid.Row="1" Grid.Column="0">
                    <HorizontalStackLayout Spacing="10" Padding="6,4">

                        <!-- Position Size -->
                        <Grid HorizontalOptions="Start" RowDefinitions="Auto,Auto" ColumnDefinitions="Auto,*">
                            <Label Grid.Row="0" Grid.ColumnSpan="2" Text="Position Size ($)" />
                            <Entry x:Name="PositionEntry" Grid.Row="1" Grid.Column="0" WidthRequest="120" HorizontalTextAlignment="End" Placeholder="500" Keyboard="Numeric" TextChanged="OnPositionTextChanged"/>
                            <HorizontalStackLayout Grid.Row="1" Grid.Column="1" Spacing="4" VerticalOptions="Center">
                                <Button Text="$5K" Style="{StaticResource ChipButton}" Clicked="OnPositionPresetClicked"/>
                                <Button Text="$10K" Style="{StaticResource ChipButton}" Clicked="OnPositionPresetClicked"/>
                                <Button Text="$25K" Style="{StaticResource ChipButton}" Clicked="OnPositionPresetClicked"/>
                            </HorizontalStackLayout>
                        </Grid>

                        <!-- Stop Loss -->
                        <Grid HorizontalOptions="Start" RowDefinitions="Auto,Auto" ColumnDefinitions="Auto,*" Margin="8,0,0,0">
                            <Label Grid.Row="0" Grid.ColumnSpan="2" Text="Stop Loss ($)" />
                            <Entry x:Name="StopLossEntry" Grid.Row="1" Grid.Column="0" WidthRequest="140" HorizontalTextAlignment="End" Placeholder="130.00" Keyboard="Numeric" TextChanged="OnStopLossTextChanged"/>
                            <HorizontalStackLayout Grid.Row="1" Grid.Column="1" Spacing="4" VerticalOptions="Center">
                                <Button Text="$0.20" Style="{StaticResource ChipButton}" Clicked="OnStopLossPreset"/>
                                <Button Text="$0.50" Style="{StaticResource ChipButton}" Clicked="OnStopLossPreset"/>
                                <Button Text="$1.00" Style="{StaticResource ChipButton}" Clicked="OnStopLossPreset"/>
                            </HorizontalStackLayout>
                        </Grid>

                        <!-- Profit Taking -->
                        <Grid HorizontalOptions="Start" RowDefinitions="Auto,Auto" ColumnDefinitions="Auto,*">
                            <Label Grid.Row="0" Grid.ColumnSpan="2" Text="Profit Taking" />
                            <Entry x:Name="ProfitEntry" Grid.Row="1" Grid.Column="0" WidthRequest="90" Placeholder="%" Keyboard="Numeric" HorizontalTextAlignment="End"/>
                            <HorizontalStackLayout Grid.Row="1" Grid.Column="1" Spacing="4" VerticalOptions="Center">
                                <Button Text="10%" Style="{StaticResource ChipButton}" Clicked="OnProfitPresetClicked"/>
                                <Button Text="20%" Style="{StaticResource ChipButton}" Clicked="OnProfitPresetClicked"/>
                                <Button Text="30%" Style="{StaticResource ChipButton}" Clicked="OnProfitPresetClicked"/>
                                <Button Text="Rem" Style="{StaticResource ChipButton}" Clicked="OnProfitPresetClicked"/>
                                <Button Text="All" Style="{StaticResource ChipButton}" Clicked="OnProfitPresetClicked"/>
                            </HorizontalStackLayout>
                        </Grid>

                    </HorizontalStackLayout>
                </ScrollView>

                <!-- BOTTOM RIGHT: Actions -->
                <VerticalStackLayout Grid.Row="1" Grid.Column="1" Spacing="6" HorizontalOptions="End" Padding="0,0,2,0">
                    <Label Text="Actions" />
                    <HorizontalStackLayout Spacing="6">
                        <Button Text="Invalidate" Style="{StaticResource ActionDanger}" />
                        <Button Text="Breakeven" Style="{StaticResource ActionNeutral}" />
                    </HorizontalStackLayout>
                </VerticalStackLayout>

            </Grid>
        </Frame>
    </Grid>
</ContentPage>
